\documentclass[a5paper]{article}
% Uncomment the following line to allow the usage of graphics (.png, .jpg)
%\usepackage[pdftex]{graphicx}
% Comment the following line to NOT allow the usage of umlauts

\pagestyle{empty}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{cmap}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{units}
\usepackage{fancyhdr}
\usepackage{forloop}
\usepackage{amssymb}
\usepackage{url}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amscd}
\usepackage[ruled,vlined]{algorithm2e}

%------------- TIKZ --------------------
\definecolor{bblue}{rgb}{0.2, 0.4, 0.8}
\definecolor{bgreen}{rgb}{0.2, 0.6, 0.4}
\definecolor{bred}{rgb}{0.8, 0.4, 0.2}
\definecolor{bviolet}{rgb}{0.7, 0.2, 0.7}
\definecolor{blackred}{rgb}{0.6, 0.3, 0.3}
\definecolor{blackblue}{rgb}{0.3, 0.3, 0.6}

\usepackage{tikz}
\usetikzlibrary{fit,arrows,trees,shapes,snakes,shapes.geometric,calc}
\tikzset{
  treenode/.style = {align=center, inner sep=0pt, text centered,
    font=\sffamily},
  arn_nn/.style = {treenode, circle, bblue, draw=bblue, 
    fill=bblue!10,
    minimum width=0.5em, minimum height=0.5em
},% arbre rouge noir, noeud rouge
  arn_n/.style = {treenode, circle, bblue, draw=bblue, 
    text width=1.5em, very thick,
    fill=bblue!10},% arbre rouge noir, noeud rouge
  arn_g/.style = {treenode, circle, bgreen, draw=bgreen, 
    text width=1.5em, very thick,
    fill=bblue!10},% arbre rouge noir, noeud rouge
  arn_r/.style = {treenode, circle, bred, draw=bred, 
    text width=1.5em, very thick,
    fill=bred!10},% arbre rouge noir, noeud rouge
  arn_x/.style = {treenode, triangle, draw=black,
    minimum width=0.5em, minimum height=0.5em},% arbre rouge noir, nil
  triangle/.style = {treenode, bred, draw=bred, fill=bred!20, regular polygon, regular polygon
    sides=3, very thick, text width=1.5em }
}

\renewcommand{\thesection}{\arabic{section}}

\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\fancyhead[R]{\thepage}
%For multipage documents only!
%\fancyfoot[L]{page: \thepage}
\fancyhead[L]{Перечислительная комбинаторика}
\fancyfoot[C]{\topic}
\pagestyle{fancy}

\renewcommand{\baselinestretch}{1.0}
\renewcommand\normalsize{\sloppypar}

\setlength{\topmargin}{-0.5in}
\setlength{\textheight}{6.5in}
\setlength{\oddsidemargin}{-0.3in}
\setlength{\evensidemargin}{-0.3in}
\setlength{\textwidth}{4.5in}
\setlength{\parindent}{0ex}

\newcounter{problemset}
\newcounter{totalpages}
%Here you should set the total number of pages
\setcounter{totalpages}{1}

\def \topic {Экзамен по курсу перечислительной комбинаторики.
Тестовый вариант.}

\def \Z {\mathbb Z}
\def \R {\mathbb R}
\def \P {\mathbb P}
\def \C {\mathbb C}
\def \vec {\boldsymbol}

\theoremstyle{definition}
\newtheorem{lemma}{Лемма}
\newtheorem{example}{Пример}
\newtheorem{corollary}{Следствие}
\newtheorem{problem}{Задача}
\newtheorem*{theorem}{Теорема}
\newtheorem*{definition}{Определение}
\newtheorem*{solution}{Решение}

\usepackage{titlesec}

\makeatletter
\renewcommand{\section}{\@startsection
{section}%                   % the name
{1}%                         % the level
{\z@}%                       % the indent / 0mm
{-\baselineskip}%            % the before skip / -3.5ex \@plus -1ex \@minus 
%%-.2ex
{0.5\baselineskip}%          % the after skip / 2.3ex \@plus .2ex
{\centering\large\scshape}} % the style

\renewcommand{\subsection}{\@startsection
{subsection}%                % the name
{1}%                         % the level
{\z@}%                       % the indent / 0mm
{-\baselineskip}%            % the before skip / -3.5ex \@plus -1ex \@minus 
%%-.2ex
{0.5\baselineskip}%          % the after skip / 2.3ex \@plus .2ex
{\centering\large\scshape}} % the style
\makeatother

\def\seq{\text{\textsc{seq}}}   
\def\cyc{\text{\textsc{cyc}}}   
\def\set{\text{\textsc{set}}}   
\def\C{\mathbb C}

\begin{document}

\begin{center}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\HRule \\[0.2cm]
{ \Large \bfseries \topic} %\\[0.2cm]
\HRule

\end{center}

\begin{minipage}{0.6\textwidth}
\begin{problem}
Рассмотрим множество \emph{плоских корневых деревьев}, содержащих \( n \) вершин. В этой задаче 
под плоским корневым деревом понимается дерево (граф без циклов), у которого
выделена одна вершина (мы называем её корневой вершиной), и граф ``нарисован на
плоскости'', то есть порядок смежных вершин по часовой стрелке имеет значение.
\end{problem}

\end{minipage}%
\hfill%
\begin{minipage}{0.4\textwidth}
\raggedleft
\begin{tikzpicture}[>=stealth',level/.style={sibling distance = 1.5cm/#1,
  level distance = 1.5cm, thick}] 
\draw

node[triangle]{\( T \)}
++(1.1,0)
node{\( \boldsymbol = \)}
++(1,0.5)
node(up)[arn_n]{\( \bullet \)}
    child{
        node[triangle]{\( T \)}
    }
    child{
        node[triangle]{\( T \)}
    }
++(0,-1.5)
node{\( \cdots \)}
++(0,-0.65)
node{\(\underbrace{\phantom{\qquad \qquad \qquad \qquad}}_{\geq 0} \)}
;
\end{tikzpicture}
\end{minipage}
\vspace{.05cm}

Выберем случайное дерево случайно равновероятно среди множества всех таких
деревьев на \( n > 1 \) вершинах. Докажите, что математическое ожидание количества
\emph{листьев} в таком дереве в точности равно \( \frac{n}{8} \).
\begin{solution}
Будем считать, что в каждом дереве содержится хотя бы одна вершина (это не
влияет на ответ задачи при \( n > 1 \), но упростит нам вычисления).
Обыкновенная производящая функция \( T(x) \) для деревьев (Каталана)
удовлетворяет уравнению
\begin{equation}
    T(x) = x \cdot \dfrac{1}{1- T(x)}
    \enspace .
\end{equation}
Чтобы ответить на вопрос задачи, недостаточно просто решить это уравнение, но мы
на всякий случай это сделаем. Я хочу обратить внимание на то, что пристальное
вглядывание в это уравнение позволяет нам убедиться, что оно имеет единственное
решение в классе формальных степенных рядов. Действительно, мы видим, что \( T(0) =
0 \), то есть свободный член равен нулю. Поэтому разложение \( \dfrac{1}{1 -
  T(x)} \) начинается с единицы, и коэффициент при \( x \) в правой части равен
\( 1 \). Имея эту информацию, можно подставить \( T(x) = x + Q(x) \), получая
\begin{equation}
   T(x) = \dfrac{x}{1 - T(x)} = \dfrac{x}{1 - x - Q(x)} = 
    x (1 + (x + Q(x)) + \ldots) = x + x^2 + \ldots
\end{equation}
Таким образом, за второй шаг подстановки мы можем понять, что коэффициент при \(
x^2 \) равен \( 1 \). 

Уравнение является квадратным относительно \( T(x) \).
Если домножить обе части на знаменатель, то мы получаем
\begin{equation}
    T(x) - T(x)^2 = x
\end{equation}
Это уравнение имеет два решения, но у одного из решений, если разложить его в
формальный степенной ряд, появляются отрицательные коэффициенты, поэтому оно не
является производящей функцией количества таких деревьев.
Выписываем то решение, которое является  нужным нам формальным
степенным рядом
\begin{equation}
    T(x) = \dfrac{1 - \sqrt{1 - 4x}}{2} = -\sum_{n \geq 1} \dfrac{(-4)^{n}}{2} {1/2
\choose n} x^n \enspace .
\end{equation}
\def\uu{ {\color{blackred}u} }
Затем рассмотрим производящую функцию от двух переменных \( T(z, \uu) \), 
где переменная \( \uu \) маркирует листья дерева, то есть коэффицент
\( [z^n \uu^k] T(z, \uu) \) равен количеству деревьев на \( n \) вершинах, у
которых имеется \( k \) листьев. Как построить такую функцию? Нужно лишь учесть
листовые вершины в конструкции дерева.

\begin{figure}[hbt]
\centering
\begin{tikzpicture}[>=stealth',level/.style={sibling distance = 1.5cm/#1,
  level distance = 1.5cm, thick}] 
\draw
node[triangle]{\( T \)}
++(1.1,0.2)
node{\( \boldsymbol = \)}
++(1,0)
node[arn_g](marked){ \( \uu \) }
++(1,0)
node{\( \boldsymbol + \)}
++(1,0.5)
node(up)[arn_n]{\( \bullet \)}
    child{
        node[triangle]{\( T \)}
    }
    child{
        node[triangle]{\( T \)}
    }
++(0,-1.5)
node{\( \cdots \)}
++(0,-0.65)
node{\(\underbrace{\phantom{\qquad \qquad \qquad \qquad}}_{\geq 1} \)}
;
\node[rectangle,dashed,draw,fit=(marked),
rounded corners=3mm,inner sep=8pt, bgreen] {};
\end{tikzpicture}
\end{figure}
Получаем уравнение на производящую функцию
\begin{equation}
    T(z, \uu) = z \uu + \dfrac{z T(z, \uu)}{1 - T(z, \uu)}
    \enspace ,
\end{equation}
и это уравнение тоже квадратное, и снова легко решается:
\begin{equation}
    T(z, \uu) = \dfrac{z\uu - z + 1 - \sqrt{(z\uu-z+1)^2-4z\uu}}{2}
    \enspace .
\end{equation}
Можно заметить, что подстановка \( \uu = 1 \) возвращает нас к непомеченным
деревьям, значит, мы всё делаем правильно.

При этом та самая производящая функция моментов, которая возникает в теории
вероятности, здесь поможет нам посчитать матожидание. В действительности, 
если обозначить \( L_n \) случайную величину, которая равна количеству листьев в
случайно выбранном дереве размера \( n \), то для неё выполнено
\begin{equation}
    \mathbb E u^{L_n} = \dfrac{[z^n] T(z, \uu)}{[z^n]T(z,1)} 
    \enspace ,
\end{equation}
Значит, матожидание можно найти, продифференцировав обе части:
\begin{equation}
    \mathbb E L_n = \left. \dfrac{d}{d \uu} \mathbb E u^{L_n} \right|_{\uu = 1}
    = \dfrac
        {\left. [z^n] \dfrac{d}{d \uu} T(z, \uu)\right|_{\uu = 1}}
        {[z^n] T(z, 1)}
    \enspace .
\end{equation}
Дифференцируем числитель и подставляем \( \uu = 1 \). Получаем:
\begin{equation}
    T'_{\uu}(z, 1) = z + \dfrac{z}{2 \sqrt{1 - 4z}} \enspace .
\end{equation}
Отношение числителя и знаменателя можно выразить с помощью биномиальной теоремы:
\begin{multline*}
    \dfrac
        { [z^n] \tfrac12 z(1-4z)^{-1/2} }
        { [z^n] -\tfrac12 (1-4z)^{1/2} }
    = 
    \dfrac
        { (-4)^{n-1} {-1/2 \choose n-1} }
        { -(-4)^n {1/2 \choose n} }
    \\=
    \dfrac{n! (-\tfrac12)(-\tfrac12-1) \ldots (-\tfrac12 - (n-1) + 1)}
    {4(n-1)! (\tfrac12)(\tfrac12 - 1) \ldots (\tfrac12 - n + 1)}
    = \dfrac{n}{8}
    \enspace .
\end{multline*}
Таким образом, при \( n \geq 2 \) математическое ожидание доли листьев в случайно
выбранном дереве составляет в точности \( \dfrac18 \).

\end{solution}

\noindent\begin{minipage}{0.6\textwidth}
\begin{problem}
\emph{Возрастающий алмаз} это
направленный ациклический граф (то есть граф, в котором рёбра имеют ориентацию, и
не существует цикла, идущего по рёбрам графа),
построенный на вершинах с различными метками от \( 1 \) до \( n \), имеющий
\textit{исток} (вершина, из которой можно попасть куда угодно) и \textit{сток}
(вершина, в которую можно попасть откуда угодно), причём граф обладает
свойством, что вдоль каждого пути номера меток возрастают.
\begin{enumerate}
\item Докажите, что экспоненциальная производящая функция количества
возрастающих алмазов имеет вид
\begin{equation}
    f(z) = \log \dfrac{1}{1 - \sin z}
    \enspace .
\end{equation}
\end{enumerate}
\end{problem}%
\end{minipage}%
\hfill%
\begin{minipage}{0.3\textwidth}\raggedleft
\begin{tikzpicture}[>=stealth',thick, node distance=1.5cm] 
   \draw           
   node[arn_r](1)                           { \( 1 \) }
   node[arn_n](2)  [below right of = 1    ] { \( 2 \) } 
   node[arn_n](4)  [below left of  = 1    ] { \( 4 \) } 
   node[arn_n](5)  [below left of  = 2    ] { \( 5 \) } 
   node[arn_n](3)  [below right of = 2    ] { \( 3 \) } 
   node[arn_n](7)  [below of       = 5    ] { \( 7 \) } 
   node[arn_n](8)  [below right of = 7    ] { \( 8 \) } 
   node[arn_n](6)  [below left  of = 7    ] { \( 6 \) } 
   node[arn_r](9)  [below left  of = 8    ] { \( 9 \) } 
   ;
   \path[->] (1) edge [bblue, thick] node {} (2);
   \path[->] (1) edge [bblue, thick] node {} (4);
   \path[->] (2) edge [bblue, thick] node {} (5);
   \path[->] (2) edge [bblue, thick] node {} (3);
   \path[->] (5) edge [bblue, thick] node {} (7);
   \path[->] (3) edge [bblue, thick] node {} (8);
   \path[->] (7) edge [bblue, thick] node {} (8);
   \path[->] (4) edge [bblue, thick] node {} (6);
   \path[->] (6) edge [bblue, thick] node {} (9);
   \path[->] (8) edge [bblue, thick] node {} (9);
\end{tikzpicture}
\end{minipage}
\begin{enumerate}
\item[2.] 
Докажите, что при больших \( n \)
количество возрастающих алмазов \( B_n \), построенных на \( n \) вершинах,
удовлетворяет свойству
\begin{equation}
    B_n \underset{n \to \infty}{\sim} 2 (n-1)! \left( \frac{2}{\pi} \right)^n
    \enspace .
\end{equation}
\end{enumerate}
\begin{solution}
    В этой задаче порядок обхода смежных вершин (``потомков'') не имеет
значения. Так как вершины являются ``помеченными'', то есть снабжены различными метками от
\(1 \) до \(n \), то мы используем так называемые \textit{экспоненциальные
производящие функции} вместо обыкновенных производящих функций. Определение,
напомню, такое:
\begin{equation}
    f(z) = \sum_{n \geq 0} a_n \dfrac{z^n}{n!} \enspace ,
\end{equation}
\end{solution}
где коэффициент \( a_n \) обозначает количество объектов на \( n \) вершинах, и
коэффициент формального степенного ряда дополнительно делится на \( n! \).

При этом если мы хотим образовать \textit{пару объектов}, скажем одного и того
же класса, таким образом, чтобы суммарное количество вершин в этой паре было
равно \( n \), то необходимо поместить в первый объект этой пары \( k \) вершин,
и во второй~--- \( n-k \) вершин. Далее необходимо распределить метки, и
количество способов это сделать равно \( {n \choose k} \).
Если перемножить две экспоненциальные производящие функции, то мы получим
\begin{equation}
    f(z)^2 = \sum_{n \geq 0} \left( \sum_{k=0}^n \dfrac{a_k}{k!}
        \dfrac{a_{n-k}}{(n-k)!} \right) z^n
    = \sum_{n \geq 0} \sum_{k=0}^n { n \choose k } a_{k} a_{n-k} \dfrac{z^n}{n!}
    \enspace ,
\end{equation}
то есть экспоненциальную производящую функцию для пар объектов.

Если мы хотим рассматривать только \textit{неупорядоченные пары}, то нужно
разделить полученную производящую функцию на \( 2! \), то есть на число
перестановок двух объектов:
\begin{equation}
    \dfrac{f(z)^2}{2!}
    \enspace . 
\end{equation}
Аналогично поступаем в случае, если хотим рассмотреть структуру, которая
представляет из себя \textit{множество} из \( m \) однотипных объектов:
производящая функция имеет вид
\begin{equation}
    \dfrac{f(z)^m}{m!} \enspace .
\end{equation}
Чтобы рассмотреть множества, которые могут состоять из всевозможного количества
объектов данного типа, нужно сложить производящие функции по всем возможным \( m
\):
\begin{equation}
    \text{\textsc{set}} [ f(z) ] = \sum_{m \geq 0} \dfrac{f(z)^m}{m!} = e^{f(z)}
\end{equation}
За эту формулу данный тип производящих функций и получил название
\textit{экспоненциальные} производящие функции.

Рассмотрим ещё одну операцию: дифференцирование. При дифференцировании
формального степенного ряда происходит следующее:
\begin{equation}
    \dfrac{d}{dz} \sum_{n \geq 0} a_n \dfrac{z^n}{n!} = 
    \sum_{n \geq 0} n a_n \dfrac{z^{n-1}}{n!} = 
    \sum_{n \geq 0} a_n \dfrac{z^{n-1}}{(n-1)!}
\end{equation}
Комбинаторный смысл этого тождества следующий: мы рассматриваем объект размера
\( n \) (имеющий \( n \) вершин), и говорим, что в его производном классе это
всё ещё тот же объект, но его размер мы теперь считаем \( (n-1) \). Самый
простой способ это сделать~--- ``обезразмерить'' какую-нибудь вершину, скажем,
вершину с наибольшим или с наименьшим номером.

\noindent\begin{minipage}{0.6\textwidth}
Вернёмся к возрастающим алмазам. Данный граф, в отличие от предыдущей задачи, не
является \textit{плоским}, поэтому порядок смежных вершин не важен. Если мы
берём вершины с наибольшим и наименьшим номером, и ``обезразмериваем'' их, то
граф распадается на \textit{множество} таких же графов (при этом необходимо
помнить, что метки внутри подграфов тоже возрастают вдоль путей).
Получается дифференциальное уравнение:
\begin{equation}
    f''(z) = e^{f(z)}
    \enspace ,
\end{equation}
\mbox{с начальными условиями \( f(0) = 0 \),~\( f'(0) = 1 \)}.
\end{minipage}%
\hfill%
\begin{minipage}{0.3\textwidth}\raggedleft
\begin{tikzpicture}[>=stealth',thick, node distance=1.5cm] 
   \draw           
   node[arn_r](1)                           { \( \ast \) }
   node[arn_n](2)  [below right of = 1    ] { \( 2 \) } 
   node[arn_n](4)  [below left of  = 1    ] { \( 4 \) } 
   node[arn_n](5)  [below left of  = 2    ] { \( 5 \) } 
   node[arn_n](3)  [below right of = 2    ] { \( 3 \) } 
   node[arn_n](7)  [below of       = 5    ] { \( 7 \) } 
   node[arn_n](8)  [below right of = 7    ] { \( 8 \) } 
   node[arn_n](6)  [below left  of = 7    ] { \( 6 \) } 
   node[arn_r](9)  [below left  of = 8    ] { \( \ast \) } 
   ;
   \path[->] (1) edge [bblue, thick] node {} (2);
   \path[->] (1) edge [bblue, thick] node {} (4);
   \path[->] (2) edge [bblue, thick] node {} (5);
   \path[->] (2) edge [bblue, thick] node {} (3);
   \path[->] (5) edge [bblue, thick] node {} (7);
   \path[->] (3) edge [bblue, thick] node {} (8);
   \path[->] (7) edge [bblue, thick] node {} (8);
   \path[->] (4) edge [bblue, thick] node {} (6);
   \path[->] (6) edge [bblue, thick] node {} (9);
   \path[->] (8) edge [bblue, thick] node {} (9);
\node[rectangle,dashed,draw,fit=(4)(6),
rounded corners=3mm,inner sep=4pt, bgreen] {};
\node[rectangle,dashed,draw,fit=(2)(5)(7)(3)(8),
rounded corners=3mm,inner sep=4pt, bgreen] {};
\node[rectangle,dashed,draw,fit=(5)(7),
rounded corners=3mm,inner sep=2pt, bgreen] {};
\node[rectangle,dashed,draw,fit=(3),
rounded corners=3mm,inner sep=2pt, bgreen] {};
\end{tikzpicture}
\end{minipage}
Самая интересная часть задачи состоит в том, чтобы решить это дифференциальное
уравнение. Домножим обе части на \( 2 f'(z) \):
\begin{equation}
    2 f'(z) f''(z) = e^{f(z)} f'(z)
    \enspace .
\end{equation}
Обе части являются производными от других известных функций, поэтому можно
проинтегрировать (при этом не забывая про константы, которые легко получить из
пределов интегрирования):
\begin{equation}
    \dfrac{d}{dz} \left( f'(z)^2 \right) = \dfrac{d}{dz} \left( 2e^{f(z)} \right)
\enspace ,
\end{equation}
\begin{equation}
    f'(z)^2 - f'(0)^2 = 2e^{f(z)} - 2e^{f(0)}
    \enspace .
\end{equation}
Подставляя начальные условия, получаем дифференциальное уравнение, которое
решается приёмом, известным вам из физики~--- ``разделение переменных''.
\begin{equation}
    f'(z) = \sqrt{2e^{f(z)} - 1} \, , \enspace
    \dfrac{df}{dz} = \sqrt{2 e^{f} - 1}
\end{equation}
Не забываем про пределы интегрирования!
\begin{equation}
    \int_{f(0)}^{f(z)} \dfrac{df}{\sqrt{ 2e^f - 1}} = \int_0^z dz
\end{equation}
Для того, чтобы взять интеграл в левой части, делаем замену переменных: \( t =
\sqrt{2 e^f - 1} \). Помним про то, что все замены придётся ``разворачивать''
обратно, чтобы подставить пределы интегрирования. Можно просто менять пределы по
ходу замены. 
\begin{equation}
    dt = \dfrac{e^f}{\sqrt{2 e^f - 1}} df\, , 
    \quad
    e^f = \dfrac{t^2 + 1}{2}
\end{equation}
\begin{equation}
    \int_{f(0)}^{f(z)} \dfrac{2}{t^2 + 1} dt = z
    \, , \quad
    2 \cdot \left[\arctan t - \arctan 1 \right] = z 
    \enspace .
\end{equation}
Пользуясь тем, что \( \arctan 1 = \dfrac{\pi}{4} \), \( t = \sqrt{2 e^f - 1} \),
получаем
\begin{equation}
    \arctan \sqrt{2 e^f - 1} = \dfrac{z}{2} + \dfrac{\pi}{4}
    \, , \quad
    2 e^f - 1 = \tan^2 \left(  \dfrac{z}{2} + \dfrac{\pi}{4} \right)
\end{equation}
Пользуясь тригонометрическими соотношениями
\begin{equation}
    \tan^2 x + 1 = \dfrac{\sin^2 x + \cos^2 x}{\cos^2 x} = \dfrac{1}{\cos^2 x}
\enspace ,
\end{equation}
а также формулой половины косинуса
\begin{equation}
    2 \cos^2 \theta/2 = 1 + \cos 2 \theta
    \enspace ,
\end{equation}
получаем решение дифференциального уравнения:
\begin{equation}
    e^f = \dfrac{1}{1 - \sin z}
    \, , \quad
    f(z) = \log \dfrac{1}{1 - \sin z}
    \enspace .
\end{equation}
Для того, чтобы верно найти асимптотику роста коэффициентов, нужно локализовать
``сингулярность'' (особенность) комплекснозначной функции, которая находится на
наименьшем расстоянии от нуля (остальные члены в разложении будут пренебрежимо
малы). При желании, если вам известны все особенности комплекснозначной функции,
вы можете получить полное разложение, но этого не требуется.

Ближайшая к нулю точка, в которой синус обращается в ноль это \( \pi / 2
\), около этой точки функция (асимптотически) раскладывается в ряд
\begin{equation}
    C + 2 \log \dfrac{1}{1 - \frac{2}{\pi} z}
\end{equation} 
Коэффициенты ряда Тейлора данной функции имеют вид
\begin{equation}
    [z^n] 2\log \dfrac{1}{1 - \frac{2}{\pi}z} = \dfrac{2}{n} \left( \frac{2}{\pi}
\right)^n 
\end{equation}
Следовательно, чтобы получить количество заданных структур, нужно умножить этот
ответ на \( n! \), в результате
\begin{equation}
    B_n \underset{n \to \infty}\sim 2 (n-1)! \left( \frac{2}{\pi} \right)^n
\enspace .
\end{equation}

\begin{problem}
Рассмотрим множество всех путей на плоскости из точки \( (0,0) \) в точку \(
(n,n) \), которые состоят только из отрезков вида ``вправо'' \( (1,0) \) и ``вверх'' \(
(0,1) \). Известно, что число таких путей равно \( {2n \choose n} \), как нас
учили в курсе комбинаторики. Выберем среди всех таких путей из \( (0,0) \) в \(
(n,n) \) один путь случайно равновероятно. Количество пересечений этого пути с
диагональю (то есть количество точек вида \( (i,i) \), которые лежат на этом
пути), это случайная величина, которую мы обозначим \( U_n \). Докажите, что
матожидание \( U_n \) имеет асимптотику
\begin{equation}
    \mathbb E U_n \sim \sqrt{\pi n}
\end{equation}
\end{problem}

\begin{solution}
Задача с mathoverflow. Найти количество пересечений (возможно касаний) с
диагональю путь в квадрате \( n \times n \).               

Consider generating function of lattice paths which don't touch and don't cross the diagonal:
$$
    Cat(z) = \dfrac{1 - \sqrt{1 - 4z}}{2} = z + z^2 + 2z^3 + 5z^4 + 14z^5 + \ldots
$$
Then we take product of $ k $ Catalan generating series which stands for lattice paths touching or crossing exactly $ k$ points:
$$
    [z^n] (Cat(z))^k = \text{\# lattice paths from $(0,0)$ to $(n,n)$ having $k$ diagonal points}
$$
Then we assemble everything into bivariate generating function, adding multiple $2^k$ for two different possible sides of Catalan paths:
$$
    F(z,u) = \sum_{k \geq 1} 2^k(Cat(z))^k u^k = \dfrac{1}{1 - u(1 - \sqrt{1-4z})}
$$
Note that if we plug $u=1$ then we obtain all possible paths from $(0,0)$ to $(n,n)$ regardless of number of diagonal crosses:
$$
    \dfrac{1}{\sqrt{1-4z}} = 1 + 2z + 6z^2 + 20z^3 + \ldots = \sum_{n \geq 0} {2n \choose n} z^n \enspace .
$$
According to the method of bivariate generating functions, the expectation is expressed by applying the point derivative operator:
$$
    u \dfrac{d}{du} \sum_{n, k, \geq 0} a_{n,k} z^n u^k = 
    \sum_{n, k, \geq 0} k a_{n,k} z^n u^k \enspace ,
$$
Denoting by $[z^n]f(z)$ the coefficient at $z^n$ in function $f(z)$, and by $U_n$ – random variable denoting the number of crossings, we obtain
$$
    \mathbb E U_n = \dfrac{[z^n] \left.u \dfrac{d}{du} F(z,u)\right|_{u=1}}{[z^n] \left.F(z,u)\right|_{u=1}} \enspace .
$$
$$
    \left.\dfrac{d}{du}\dfrac{1}{1 - u(1 - \sqrt{1-4z})} \right|_{u=1} = 
    \left.\dfrac{1 - \sqrt{1-4z}}{\left[1 - u(1 - \sqrt{1-4z})\right]^2} \right|_{u=1} =
    \dfrac{1 - \sqrt{1-4z}}{1 - 4z}
$$
Applying asymptotic extraction of coefficients,
$$
    \mathbb E U_n =
    \dfrac{[z^n] \dfrac{1}{1 - 4z}}
    {[z^n] \dfrac{1}{\sqrt{1 - 4z}}} = 
    \dfrac{4^n}{ {2n \choose n} } \sim \sqrt{ \pi n}
$$
\end{solution}
    
\begin{problem} Рассмотрим множество бинарных строк \( \{ a, b \}^\ast \), то
есть строк, состоящих из символов \( a, b \), при этом строка может иметь длину
\( 0 \). Будем говорить, что \emph{паттерн \( P = (P_1 P_2 \ldots P_3) \)
встречается в строке \( S = (S_1 S_2 \ldots S_n) \)}, если существует такой индекс \( i \), что
\begin{equation}
    S_i = P_1, \, 
    S_{i+1} = P_2, \,
    \ldots, \,
    S_{i+k-1} = P_k \enspace .
\end{equation}
Если паттерн \( P \) встречается в строке \( S \), и из всех таких индексов \( i
\) выбрать минимальный, то число \( (i+k-1) \) называется \emph{временем
ожидания паттерна \( P \)}.
\begin{enumerate}
\item Сколько существует бинарных строк длины \( n \), в которых не встречается
паттерн \( abb \)? 
\item Чему равно среднее время ожидания паттерна \( abb \)?
\end{enumerate}
\end{problem}       

\begin{solution}

\end{solution}

\subparagraph*{Источник задач}
\begin{enumerate}
\item Придумал из головы (скорее всего фольклор).
\item Increasing Diamonds. Olivier Bodini, Matthieu Dien, Xavier Fontaine,
Antoine Genitrini, Hsien-Kuei Hwang. LATIN-2016.
\item Expected number of crossings of the diagonal of a lattice path? 

\url{https://mathoverflow.net/a/266993/90511}
\item Philippe Flajolet, Robert Sedgewick. Analytic Combinatorics.
\end{enumerate}

\end{document}

